## 3장 아키텍처
- [MySQL 전체 구조](#mysql-전체-구조)
- [MySQL 스레드](#mysql-스레드)
- [MySQL 핸들러](#mysql-핸들러)

### MySQL 전체 구조
![3-1.png](images%2F3-1.png)

MySQL의 전체 구조는 다음과 같다. MySQL의 서버는 **MySQL 엔진과 스토리지 엔진으로 구성되어 있다.
**
MySQL 엔진은 클라이언트의 접속과 쿼리 요청을 처리하는 커넥션을 처리한다. 스토리지 엔진은 실제 데이터를
디스크 저장소에 쓰거나 읽는 역할을 수행한다. 따라서 MySQL 서버에서 MySQL 엔진은 하나지만
여러 개의 스토리지 엔진을 가질 수 있다.

![3-2.png](images%2F3-2.png)
이처럼 현재 MySQL에 사용되는 스토리지 엔진을 조회할 수 있는데, **DEFAULT**로 설정된 엔진이
활성화된 엔진이면서 필수 스토리지 엔진임을 의미한다. (InnoDB)

### MySQL 스레드
MySQL은 프로세스가 아닌 스레드 기반으로 동작한다.
1. 포그라운드 스레드(클라이언트 스레드)
- 앞단에 있는 스레드로, 클라이언트가 요청한 쿼리문을 처리하는 것이 주된 임무이다.
- 사용자와의 작업을 마치고 커넥션을 종료하면 이들은 쓰레드 풀로 되돌아간다.
  - 쓰레드 풀은 일정한 사이즈(`thread_cache_size`)만큼 유지한다.
- 포그라운드 스레드는 MySQL의 **데이터 버퍼나 캐시에서 가져오거나 직접 디스크에서 데이터를 읽어온다.**
2. 백그라운드 스레드
- 대부분의 데이터 쓰기 작업은 버퍼에 모았다가 한번에 처리된다. 그래야 네트워크 자원을 아낄 수 있기 때문이다.
- 반면에 읽기 작업은 버퍼링되어 처리할 수 없다. 읽기는 요청 즉시 바로바로 수행되어야 하기 때문이다.

![3-3.png](images%2F3-3.png)

또한 MySQL 서버의 메모리 할당은 글로벌과 로컬 영역으로 나뉜다.
- 글로벌은 MySQL에서 사용되는 모든 스레드가 공유하는 영역이다.
- 로컬 영역은 각 스레드가 쿼리를 처리하는데 사용되는 메모리 영역이다.

### MySQL 핸들러
핸들러는 MySQL 엔진과 스토리지 엔진(InnoDB, MyISAM)이 통신하는데 사용되는 것이다.
MySQL 엔진은 디스크로부터 데이터를 읽어오기 위해 스토리지 엔진에게 작업 명령을 하게 되는데
**이 때 사용되는 것이 바로 핸들러이다.**

